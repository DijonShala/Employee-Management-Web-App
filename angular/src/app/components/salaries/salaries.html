<div *ngIf="employee?.role === 'admin'" class="container-sm p-5 bg-light">
  <div *ngIf="error" class="alert alert-danger">Error adding salary.</div>
  <div *ngIf="success" class="alert alert-success">
    Salary successfully added.
  </div>
  <h3>Add a salary to this employee</h3>
  <app-nice-form
    [formcontrol]="salaryform"
    (result)="addSalary($event)"
  ></app-nice-form>

  <br />
</div>

<!-- START: Error message -->
<div class="row" *ngIf="ethereumService.errorMessage">
  <div class="col-12">
    <div class="alert alert-dark mt-4 p-2">
      <i class="fa-solid fa-triangle-exclamation pe-2"></i
      >{{ ethereumService.errorMessage }}
    </div>
  </div>
</div>
<!-- END: Error message -->

<!--
<div class="container-sm p-5 bg-light">
  <h3>Get salaries by Month / Year</h3>
  <app-nice-form
    [formcontrol]="monthform"
    (result)="fetchSalariesByMonthYear($event)"
  ></app-nice-form>

  <div *ngIf="filteredSalaries.length > 0" class="mt-4">
    <h4>Salaries for the selected month and year</h4>
    <table class="table table-bordered">
      <thead>
        <tr>
          <th>User Name</th>
          <th>Basic Salary</th>
          <th>Allowances</th>
          <th>Deductions</th>
          <th>Net Salary</th>
          <th>Pay Date</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let salary of filteredSalaries">
          <td>{{ salary.userName }}</td>
          <td>{{ salary.basicSalary }}</td>
          <td>{{ salary.allowances }}</td>
          <td>{{ salary.deductions }}</td>
          <td>{{ salary.basicSalary + (salary.allowances || 0) - (salary.deductions || 0) }}</td>
          <td>{{ salary.payDate | date: 'shortDate' }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div *ngIf="filteredSalaries.length === 0" class="mt-4">
    <p>No salaries found for the selected month and year.</p>
  </div>
</div>
-->

<div *ngIf="employee_salary.length > 0" class="container-sm p-5 mt-4 bg-light">
  <div *ngIf="rates != undefined">
    <h6>Select currency type</h6>
    <select
      [(ngModel)]="selected_currency_select_text"
      class="form-select"
      (change)="change_currency()"
    >
      <!--
      <option *ngFor="let currency of rates.rates | keyvalue">
        {{currency.key}} ({{ 0 | currency: $any(currency.key) | slice:0:1 }})
      </option>
    -->
      <option>USD ($)</option>
      <option>EUR (€)</option>
      <option>GBP (£)</option>
      <option>JPY (¥)</option>
    </select>
  </div>

  <h3>{{ employee?.userName }} salaries</h3>
  <table class="table table-bordered table-hover">
    <thead>
      <tr>
        <th>Basic Salary</th>
        <th>Allowances</th>
        <th>Deductions</th>
        <th>Net Salary</th>
        <th>Pay Date</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let salary of employee_salary">
        <td>
          {{ salary.basicSalary * conversion | currency: selected_currency}}
        </td>

        <td *ngIf="salary.allowances != undefined">
          {{ salary.allowances * conversion | currency: selected_currency}}
        </td>

        <td *ngIf="salary.deductions != undefined">
          {{ salary.deductions * conversion | currency: selected_currency}}
        </td>

        <td>
          {{ (salary.basicSalary + (salary.allowances || 0) - (salary.deductions
          || 0)) * conversion | currency: selected_currency }}
        </td>

        <td>{{ salary.payDate | date: 'shortDate' }}</td>
      </tr>
    </tbody>
  </table>
</div>

<div *ngIf="employee_salary.length > 0" class="mt-4">
  <div class="container bg-light">
    <ngx-charts-line-chart
      [view]="[1000, 400]"
      [legend]="legend"
      [showXAxisLabel]="showXAxisLabel"
      [showYAxisLabel]="showYAxisLabel"
      [xAxis]="xAxis"
      [yAxis]="yAxis"
      [xAxisLabel]="xAxisLabel"
      [yAxisLabel]="yAxisLabel"
      [timeline]="timeline"
      [results]="salarydata$ | async"
      (select)="onSelect($event)"
      (activate)="onActivate($event)"
      (deactivate)="onDeactivate($event)"
    >
    </ngx-charts-line-chart>
  </div>
</div>
